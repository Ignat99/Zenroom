local QP = require("qp")
local seed = O.from_hex("f696484048ec21f96cf50a56d0759c448f3779752f0383d37449690694cf7a68")
local sk = O.from_hex("bd4e96f9a038ab5e36214fe69c0b1cb835ef9d7c8417e76aecd152f5cddebec8e9355a9ab1bcfbfc7d4decdf5ddd94b4359823a9578a19d161c4e9ad5afd7d61746119a59589b3630773bfd350c45d029f1cd0b03163feac00f77d814cb89d963b11a8dfad7d0f31b0a542ba61044a2968d6cc435f00f5330f65063f5a46db2323b1691c044d0cb28c2487014a9230dab8510802115848401928228a468819070c5c002a0b18109b3632493810c404428498048444259a323024a4259c062cd9344454000018c58d64142113888020400c02a220811484823685d2086010a54052b231a4a48c64000c11048522868954c609cab6845346898b101122038044b0915ca00952a2288bb488612880120580c948668124925906429b280ed13005019631dbb804e2c63011024ccb406549088e0a470d53c08919b8711091651a3112ca125080242e24134a22014c1c48100a274e03354801c0819098845908851489115b400ee09885d93462c48440e4a8901b418d444031d0b420008665a2b60464964d4b1802a130660a020ee4862dd2162a9c186103220c5b3228980445d93465cb18521b11444c8084124470dca201920851100912a4880c109708c2b0290ac048e2260cdb344d9b226e030951149160c0042a1819884202665802321a366ed3127298b82914034d90b200a1c6841c121102c6015004525842685a160c03204603a40d04480c52426821271291902cd92489cb088de30481a18270c1b8280848310c499023079049b04c883422118009138225189204c240061ac18422b270e336904bc60081b83152a04923c3215206318b2605cc306a58162664108053227289348cc1288c1a118a98406008098dc9246ee4840054140e4ba00543826da0188d03922d10852519072c6440908a107064c66c51308219b56122b420540866d41641089828c3160a60286841002e492206502205ca262ddc380582203004c16562a660da0620098510888844e1c011432466c394711c47324c28125904625b8049db40211915490b3184e1206600c588c4264542c871c4263120050549127049b66dd4b66884c830c44406c1826123874dc9127018116e8b10915c0291cb8485d032620a8160423820c91820003544982886020331c120818030280c0551cc86890022065c388e24264da42888188701c2c06dd4368904b16404278ada448120c128a4a80114350e530031624651d9126d0b88040b856904c96d429050808881004b402ec8f9a63ad7db8f6c580a15254857376b862730d93f80c4976e1ef1947efa8513adc92867a377e74969510fd7417fa21bd3d773f60d20e4b2ba56cc54f7671e087c16d996c25ec97259cf8e0a4a5c823bcb4ee3ab5aa58ece39111e1513c30cb90a6453d09d79e35e7bc77a3875efea5a2f0f8e070dd14cf4fcb75f13d61ee24dbc6b9977fe0c44f17166b06d4e2425524e4ee455ced586033641c2c8ba5e9c0a8317ab418233d9ee411ef2bb013bb1d4b12d1ef8a82bc591218c3e5f7ffeb2f7b95a643b8cc46e49fdbb83656be0167b0afd3ae9205c1b02694f7df939eea45529189cd8c6ac518cdfdd0e7d0a04e521ad366d99b65b9f389dc774b15168907fba80ad2e6f540f8c36d81407f12d3dbb83ba0ef403a9db8453374c2b65aa76fb31ce475f4a857e4d155e929a77086dd169c0657c9306465910dc15966a9cde2923d9c36ecf9a82fb6ce8ad6e3362f2dfe4a6b6ff54ef1bda398d3ae032590e81923b1c5b287ef18e6d480f06d4f57552c6c74e329eb7f1326f6638935afc9a87d08147f6a3c081dbe4b7660d3bf7cc2a86bfb22cdc2a3932ecd9b20f770088c5d4a409950c3d91b5c0a87017f394af3d26d083986355553b9875720204e03eb2a8a1abc9f486ad1956717ed7d12a11a34b30b69eb3945f575f16f783e395bc63d757e0ee19e57e0fe999edc75c8ceb7d3753a1172e31255f383371a23e9914d373278d8437aa45c6cf55c188a7559659742fccf775150f8290e7faa69dbe48b09960db647c9a58c87668b534d0a3f621a7054aa67dd8e5ec09fef842ad1629d9f85462c9461afe770926bcf939769f939e8c35f61e4300a4db286463bf34eef5f4282d6b0b18be8d8eebae6863f3eaf0b0adaf8468d7264e44af2652216291ede5689f9a153e886486cdc5538ecbe575926c362f2c0c2ac473c144f9e7ccb620cee886df07fbfd812ec65f19f8d3bca0de9c999733973b3f42b354cac27cdbcb39c0988f9aedbfa3f0f772306c51260810ed526aa061ed7df06d1f9050c8efbc872e71ba80b8266b5b3da89c6a6adce973945cf6a8c25af71247bc356b92b35ba82d9cdfa189d5f1c60fece7246cddad8e3856ecf048487dc5c05cf047296b35b3d81ef889948e0a2fcd1210bb4511a5ce15a0a4d81b635b024fffcb63c3f97ccbf418fb8ab815a565a82e8065d256bd803d5b176e86c46eaaf85066e598f9ea2b7823c09c4dcdc281cc0593f2c45eafd439f067bb03712d5f2d0c4407538d9f15873474e1aac69b8bbcc4bd7fa9cda8cb20e4a551b9598a41215ae22e0d04069bffe26f338b6dcf4e25c8a36a8fc79d8abb424e40ea6e56b8549de4eca8c27151047953a5048d73d13bb718185cfcab1e85ea2ef8757306ff964c4228a004d4aa709eddd54a11cf25ca6c1c6cd70dd7eb5f8721e9f0a7d8f4a71d859b31d421099b49c393ba3044254935aba5cc5222bef7cd7e7068cee47c4165794e9c0d6f6416bb51476460c0e104cf883f482c97c2aa6ec3cfc5ce68eab2a06a1b97024cb62b4ea046e07727c328b0eda1bbda3a7a635c64a4638f93fa3efbdf757fbc9be9029bc132f296abc3b9a44224faf6bb1a3974763d81b0a1fb91472dae04ec26ef7255e449ae6e628532b912d827ad44897ee7fee066ac6062e20cd59f5481751f2751ff2dc3e117b5059e5403fd61fb36083d7ee07d053e0c52a43ecd1884a5c279364bd29f04856e92427b45cfc5b6c3d345725e0887a1b47c9f8d8607bdb88bf0321d70cb33be6fe1c002865150aebdf3b9c5d1e004df937c565a7d3883158615e7eb13decbd2dd89a04390475e1d214eb60b7ac7ee220e3f980d1515247e0910b55a3cfab29142ebeea1e2eb8a420f33ecb1c25fa3d430ba2f4713d4cbf5a71389f96caf42943a15de969cf972bface48699a57596076f8eceb76070174d39decd0bd5866116e1a67e57d61b6b1da5c4eb830c34bce3919cd70d446da248169deacb42a5f14f4f0d12ff7575f1dd91cfcf8304b286aa4272ff32dad6156b21c3ce56a28455c88ec4b5a8003a1baa074d6a38af77c07d29854e1e7bcc6f5ef1948212831f93128b197e0383a3d2cb5ca528b16d35728fc63e41e6c5b8730e4fe3905f7ceb914d5eb239fcdc0fbe6d9d3de141129a466d68ce26224aa997d36b2eb089fd653d9efe3ba91e0fa64d5b3e495fdfab2af2a4ca04dee4c948b75cdc3fb6ec3afdf4901d53b96fae5c5a8f7fd97b4e38e09b11a41594a33b057a150dad19abc9f6541c30fcfdf73b97d10c641eb2b8c08cf2c3cb333ea307094ac5409babb3d42bba60cb4941cc63481122177421e07a99d4710f471569")
local pk = QP.mldsa44_pubgen(sk)
local keys = QP.mldsa44_keypair(seed)
assert(keys.private == sk)
assert (keys.public == pk)
local m = O.from_hex("6dbbc4375136df3b07f7c70e639e223e")
local ctx = O.from_hex("480c658c0cb3e040bde084345cef0df7")
local signature = QP.mldsa44_signature(sk,m,ctx)
local sm = O.from_hex("e7c82fca315573ef8cc7160ce95d92fa79ac21521523de0e6700768207e9b7b9fae9cbdbf8f97b06d79ed4f5ea4513086c4b065ce9296ae0cd9b133f65c314fcef6d537b1d2d7077e779be24c149d8284c82f4937b0815d656e404ad4ad87d78ddbc493c6ace7a2aab9446243f37c64d7c441212307d07a3fbe2573194c0b75ed55c398a2c633984fd397252320feffd79d892dd0ab6c9cb661e47fe8d6e76a0ff4e83abed5aea3feff912f7c5a067370ca037d88260fde55b0eb3220d44a12a39578b891ce7948db3f389b0ebda721d664e1790c40b9b8167c0d9ca03e359da4ab675ab011b0c57a7ed55cfd8c250e5b890471c1e581d3b3eb3a6f3c79223ae0e881886f4feb285442855e106070a5ef40a7a74b5e95bfd316d0fdcf464b3b2f708b2d9dcd6cc565d0b54b07e319ee413a2e430bbd855c74e9477fc06ebbdceec9c7a2ac0af875bde016c61742c62f42bbd48a3a51089b30fd5a62bf77091eda29cd722765e24ef2693bf34665cb118d9e07e846c3703461015cf1c37fdeada056ad91e67cc77139c8c27c5c6c00895a48a8f3d5bb0b3719edadb9bb666b655e218855e9d19fac78f179bf598f7de2437305691aa5b8ec57f2337a7e2d1f007d920090ebf765b98cf784f24da4f19089d1f8dfb03e5ebe676898d4067c5fc51238b2fcaccfadd4795d96899b451097d27595928d0fb0b64fb190739a51d7fe063ce0dd99a74510f080c1ef4f61cd11d9859e4ed550f6f1e4eb23f164de1d5af8f050f56eabda15e1d54766c3fbdc30f43cfd8174e3c8ca6274865ed7c7a7d1a410ab51549b5b736e0c82ed9af8241ad8a266378caa062653283e79085134b4db8917f7c8d4d8ee94b5a42aa8148b69f1f719aad9fb315a4678e91f4b4b1268d96e50921c7a68d4832ee1018bcdac84a46aa52021ea1aece7cb85ecb57bb706231df46b6f8d58f3d2880bc9b5d478af82eafb861b6a0f7e266f3ff67c3092ba326e6d827e76f5a34c52bb82c9a06a82650c9e0626c3dbe1a0a748bf89bc14dfde33185b063a9247c5997e2e08e8404abc18cfdf7d2fd8870eb8d964fdd97c3325be0bbb1a76ec220aa68b400ece8e95abcd94edc0173398d2f6badd23e33b27bf28276d7657681d7e5fc9f1b7414aab0f45b8b3149fce89c20019e70de07fc3129dfee35dd01936ab425c3f8ded9d5412aa659c20821b48cfcd7b2add251af41de2a89c94147d98de9bc0c1ccb80cbd2202b1c6134f36c3e4b953375f405541987c04c809cdf7ee42645f10ea02f193545ed8b73b48c74965083401a09dcd1c39366aa9f1bf520d19074199f3b842ce9acbc5b63eac8b383cbdfc68513ef3b05c701c2e86cd539b4332116c01d99cf3a1e6522814feb8f3e1066a63de6c482a684bf76dc7673ac775342fba58494fd3b33fe366e5aa6cd26f5893e0e7bb4a376d48a4f08dc1f23a589d9c4557a76fd7882a2ced9f588b2279bd7e9607525a16d1b0707f044237521a1a38a3a956153b99df64fd384b7ad51d3ad7fcabd86c8d1f53cf7fbad27a933ded0fffe77955338286c634e88bb1a4eef84a5d5652c01895fd0c1a73dde4200ce11dc356f876642e61a0a382af660c677d6bcbea9c5a14cee8895ff4e5a85c3dfc0a7236ea2b680a7c0e45a17e16a7650c8e9fd6bc15c1292e28f0e5e4ea88b852b6fd19d0564ef69963c707d236f51bf8a7b1caed916549e09c77be15398c07fa6efa07a5936dbd6c49826de086d7d9f394169ff4d988debb32e1a7621c0cf0d65e25c4195c9e10920bd140371978e7433353b10239edf7b3b4bce8799e568399706ea4c3e021e8f5b58007b4e8f92a6f627234eec26d7d62b28ac208ed5adf3b7dc087bfacc15800069726b24e51381e8b93dbe2a77af1e8117aaa7134c6ee2d415735cced695d0993ef1aef46edde30740f5ae55baaf20b773e05bc2d6a93655cbae36794dc09a497359236d05ce65fd82da17306a51f5c4f97d63581109ba940e7e560b0b8d922576bee0685481ec538be6eae23676804d7be1b2775403bc5816add25ef3d48c15ab0eba39910f4294566e0864361d97449c3f1f49bd8c8acafe2b5b8aa4810bcd1189af3fbf41c7c5728158bf00b8cb933d15469a9829ebc058c3b76389552e156a857d2428f6040b3a05b0d55f16beb426def5b02e1d97741cbd0de1169623b597ea0dc6f2afd8a259d29ae33e6c20940d7906c0999138ca7333b47ff253eabaf912153dca52bb201e11e98aa60b253e7f03fc084553885fef8a879094b52c46de225f1315a5464e0b8e6cabd5dc4fe7d7fe25f501b7fb129e14ef6753135a4be3885914393504e99159866f5af3e6fe4deb8d965e9ea00641398ec4317f3ca8403cfd8442d88894a2e4128464bf57c093198c6ae984024a175ddaedcb31b5c532019fea4f8fd2d3d3dcc6283fb52ca75383a4664777acca3fd158b4d080e3546a8ec33ce3fa794777c03783897876bb5166dc5474547043d62d90ac6f818ebb459d1c6146bb57769327f2b5f366ee07061f49c5d9d5914aca7900162aaa1aaf8fd9ca72ba72a56b1a4ce400651975edc9c206ed4c1e58884e6f24680b64be1a6a611483a72a7cfb7fff85c8365ea880687b468484031f06ab419e76fe3eb6bf9448315d781a46b87ab3ebd490e6be17f7804881a0f6c53547698d53d64d8763f35a8e8a45392f43b1a1dbccf8e792adf79d1186f3ae1d5d9e121204b198cc1e48ea855b9715d8aad487dc19708691f41048b73bed0c6f644688a57f9e7770c7d0a52c6940e2d8eb9af7101ed5d97f5eb7f22e25dd76117538fc2c08fddfc617810b7646f34c738f29cb63d6faf081aefe34ba44ddb5617bcefd63d08ddd48c43d563d29e6180479f9e5d3eb0d3c06e700ef5535b1a8ac2eec565382ab35e6298ea101ffd4a8afd45d642b326d1fb47329d16c5820935ceddd633a01f0b598843f4614fa0dffb82d9af45c69701a138dd4008c6bba84e1cb1e0943ac90f8f0e665cfe1a157a075a1d9a5e2f10cf15d01b8c5578cc02056af7c887bd936008581cf8522901122a63c1ff2404dc318d5a3bd407f89351c63a43b12eab9bf2f969abd90df6a347e5918f6a5adcb1c979e6d810e4c334ea1dddaa365120dc0c5c8af142cb3a1578188c6d75b8e3eda715a9f8547dd6e4f1474080532e26e6b6eac6d583520e3e1ff32344ab9ecb505c103569fe8276bc33d1f6ac280b1b5ac09549b8cb06180fd1faf1c7f16f818b1eb8151230dee10a108dfd1895a1ae1fbbe6b08b59c526ea69929ae8dc8635a5ea91019768e9dbcbfd9fa0a171b2028494e717a96c7d6e3fd062550515277828e8fcbd5e9eaf9fe071221252a3c465062788cacb8bbbdd1dde0e1f0fa0000000000000000000000000000000000000000000917263b")
assert(signature==sm)
assert(QP.mldsa44_verify(keys.public,signature,m,ctx))
